<!DOCTYPE html>
<html lang="en" >
  <head>
    <meta charset="UTF-8">
    <title>Cheatsheet Concept</title>
    <link rel="icon" type="image/png" sizes="32x32" href="../images/favicon.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.min.css">
    <link rel='stylesheet prefetch' href='https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.2/css/bulma.css'>
    <link rel='stylesheet prefetch' href='https://use.fontawesome.com/releases/v5.3.1/css/all.css'>
    <link rel='stylesheet prefetch' href='https://cdnjs.cloudflare.com/ajax/libs/prism/1.14.0/themes/prism.min.css'>
    <link rel="stylesheet" href="css/docs.css">

    <style type="text/css">
      .sticky {
        position: -webkit-sticky;
        position: -moz-sticky;
        position: -o-sticky;
        position: -ms-sticky;
        position: sticky;
        top: 10px;
        z-index: 1;
      }

      .is-file {
        color: orange;
        font-weight: bold;
      }

      aside {
        padding-top: 90px
      }

      :target {  
      }
    </style>
  </head>
  <body>
    <section class="hero is-primary">
      <div class="hero-body">
        <div class="columns">
          <div class="column is-12">
            <div class="container content">
              <i class="is-large fab fa-discord"></i>
              <i class="is-large fas fa-code"></i>
              <h1 class="title">Learn <em>Web Basics</em> for new-dev</h1>
              <h3 class="subtitle">
              Collection of code and explanation to get you started
              </h3>
              <a href="https://github.com/#" target="_blank" class="button is-primary is-large">
                <span class="icon">
                  <i class="fab fa-github"></i>
                </span>
                <span>Github</span>
              </a>
            </div>
          </div>
        </div>
      </div>
    </section>
    <section class="section">
      <div class="container">
        <div class="columns">
          <div class="column is-3">
            <aside class="is-medium menu sticky" id="root">
          <p class="menu-label">
            categories
          </p>
          <ul class="menu-list">
            <li><a href="index.html" class=""><i class="fab fa-html5"></i> Basic - HTML</a></li>
            <li><a href="php.html" class=""><i class="fab fa-php"></i> Basic - PHP</a></li>
            <li><a href="basic-mvc.html" class="is-active"><i class="fab fa-web"></i> Basic - MVC</a></li>
          </ul>
              <p class="menu-label">
                In This Category ...
              </p>
              <ul class="menu-part">
                <li><a href="#gettingStarted"><span class="tag is-white is-medium">Getting Started</span></a></li>
                <li><a href="#view"><span class="tag is-white is-medium">The View</span></a></li>
                <li><a href="#libs"><span class="tag is-white is-medium">Library</span></a></li>
                <li><a href="#model"><span class="tag is-white is-medium">Model</span></a></li>
                <li><a href="#controller"><span class="tag is-white is-medium">Controller</span></a></li>
              </ul>
            </aside>
          </div>
          <div class="column is-9">
            <div class="content is-medium">
          <h1 class="title is-1">Basic MVC ¯\_(ツ)_/¯</h1><hr>

          <p>This is a tutorial for creating your first web application using basic MVC structure.<p>
          <p>We will be using PHP programming language for this tutorial so you should at least have basic knowledge on programming, preferably PHP.</p>

          <div id="gettingStarted">
            <br>
            <h2 class="title is-2">Getting Started</h2><hr>
            <h4 class="title is-4">Things that you need to know</h4>
            <p>
              Before you dive into this tutorial, you must first have learn and understand these first.<br>
              Preferably in PHP because PHP is the language that we will be using in this tutorial.
            </p>

            <p>
              You can go <a href="https://ashrafkamarudin.github.io/Web-Basics/php.html">here</a> to read about them or visit <a href="https://www.w3schools.com/php/">W3Schools</a>
            </p>
            
                  <article>
                  <ul>
                    <li>Variables</li>
                    <li>Array</li>
                    <li>Foreach Loop</li>
                    <li>Class</li>
                    <li>Static Methods</li>
                  </ul>
                  </article><br>

            <h4 class="title is-4">Prerequisite</h4>
              <p>You will need a basic stacks for web development like XAMPP, WAMP, LAMP or MAMP.<br>

              Or anything else that have the following installed :
              </p>
                  <article>
                  <ul>
                    <li>PHP</li>
                    <li>MySQL</li>
                  </ul>
                  </article><br>

              <h4>Folder Structure</h4>
                <p>After you're done setting up your web development environment, create a folder structure like so</p>

                <img src="images/folder-structure.png">
          </div>
          <div id="view"><br>
            <h2 class="title is-2">The Views</h2><hr>

            <p>First, Let's create the view for our web app. Let's use <a href="https://getbootstrap.com/docs/4.1/getting-started/download/">Bootstrap</a> as our front-end framework.</p>

            <p>Create 3 new php file under views folder like so</p>

            <img src="images/view-structure.png">

            <p>I will let you design the view yourself ^_^ ~</i></p>

          </div><br>

          <div id="libs"><br>
            <h2 class="title is-2">Library</h2><hr>
            <p>This folder is called library because it contains files that will be used by our application.</p>
            <p>
            Create 2 file called Config.php and Database.php under libs directory. Config.php will have our database config in it while Database.php will have our application database connection.</p>

            <p>in <i class="is-file">Config.php</i>, add the following.</p>

            <div class="box">
                <h4 id="const" class="title is-3">Config.php</h4>
                <article class="message is-primary">
                  <span class="icon has-text-primary">
                  <i class="fab fa-php"></i>
                  </span>
                  <div class="message-body">
                    This will contain all config settings
                  </div>
                </article>

            <pre><code class="language-php">
/*
* Database Settings
*/

// define a constant variable to store our database settings
define('DB_TYPE', 'mysql');
define('DB_HOST', 'localhost');
define('DB_NAME', 'MVC');
define('DB_USER', 'root');
define('DB_PASS', '');
            </code></pre>

            </div>

            <p>Then create <i class="is-file">Database.php</i> and create a DB class with 2 static method as follow.</p>

            <div class="box">
                <h4 id="const" class="title is-3">Database.php</h4>
                <article class="message is-primary">
                  <span class="icon has-text-primary">
                  <i class="fab fa-php"></i>
                  </span>
                  <div class="message-body">
                    This will contain database class for database connection
                  </div>
                </article>

            <pre><code class="language-php">
class DB
{

  public static function connect($value='')
  {
    // create a new PDO connection
    $pdo = new PDO(DB_TYPE.':host='.DB_HOST.';dbname='.DB_NAME, DB_USER, DB_PASS);
    $pdo->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);

    return $pdo;
  }

  public static function run($sql, $args = NULL)
    {
        if (!$args) // if no parameter
        {
          // run the query straight away without parameter binding
             return DB::connect()->query($sql);
        }
        // prepare the sql query
        $stmt = DB::connect()->prepare($sql);
        // execute the query with bind parameter values
        $stmt->execute($args);
        return $stmt;
    }
}
            </code></pre>
            </div>

            <p>Then create a <i class="is-file">Bootstrap.php</i> file. This file will require all class that will be used by our application.<br></p>

            <div class="box">
                <h4 id="const" class="title is-3">Bootstrap.php</h4>
                <article class="message is-primary">
                  <span class="icon has-text-primary">
                  <i class="fab fa-php"></i>
                  </span>
                  <div class="message-body">
                    This file will load all required file the application need.
                  </div>
                </article>

            <pre><code class="language-php">
session_start();

require_once dirname(__FILE__) . '/Config.php';
require_once dirname(__FILE__) . '/Database.php';
// you can require more file here if you have more library to load
            </code></pre>
          </div><br>

          </div>

          <div id="model"><br>
            <h2 class="title is-2">Model</h2><hr>
            <p>Next we will create our model in the model directory called <i class="is-file">User.php</i> and add User class into it</p>

            <div class="box">
                <h4 id="const" class="title is-3">User.php</h4>
                <article class="message is-primary">
                  <span class="icon has-text-primary">
                  <i class="fab fa-php"></i>
                  </span>
                  <div class="message-body">
                    This is a model file for User which will contain all database operation like Create, Read, Update and Delete
                  </div>
                </article>

              <pre><code class="language-php">
/**
* Model class for User
*/
class User
{
	public $table = 'users';
	/*
	* Attributes
	* ----------
	* if you want to use private then you should have setter and getter
	* or using PHP magic methods, __SET and __GET
	*/
	public $id;
	public $name;
	public $email;
	public $password;

	/**
	* Static method All()
	* this method will retrieve all user data in database 
	* and will return the data as array of user object
	*/
	public static function All()
	{
		$query = "SELECT * FROM users";

		try {
			// use static method run() from class DB 
	    	if ($stmt = DB::run($query)) { // this will run the build query

	    		// assign all of the data fetch from database to variable data
				$users = $stmt->fetchAll(PDO::FETCH_ASSOC); // need to add fetchAll for pdo 
														    // in order for pdo to retrieve the data from database

				// return the array of users filled with user array
				return $users;
			};
		} catch (PDOException $e) {
			return $e->getMessage();
		}
	}

	/**
	* Static method getById()
	* this method will retrieve 1 row of data from database
	* based on the id passed to the method
	* @param int id
	*/
	public static function getById($id)
	{
		$query = "SELECT * FROM users WHERE id = :id LIMIT 1";
		$param = [':id' => $id]; // the parameter that will be bind by pdo

		try {
			// use static method run() from class DB 
	    	if ($stmt = DB::Run($query, $param)) { // this will run the build query

				// need to use fetch to retrieve only 1 row of data
				$user = $stmt->fetch(PDO::FETCH_ASSOC); // this will retrieve the row of data
													    // that is associated to the passed id

				// return the user object
				return $user;
			};
		} catch (PDOException $e) {
			return $e->getMessage();
		}
	}

	public function save()
	{
		$query = "INSERT INTO users (`name`, `email`, `password`) VALUES (:name, :email, :password)";
		$param = [ // the parameter that will be bind by pdo
			':name' => $this->name,
			':email' => $this->email,
			':password' => $this->password
			];	
		
		try { 
			// use static method run() from class DB
	    	if ($stmt = DB::Run($query, $param)) { // we dont use fetch() or fetchAll() here
												   // because no data will be return when we
				                                   // perform update operation
	    		return true;
	    	};
		} catch (PDOException $e) {
			return $e->getMessage();
		}
	}

	public function update()
	{
		$query = "UPDATE `users` SET `name`=:name, `email`=:email, `password`=:password WHERE `id`=:id";
		$param = [ // the parameter that will be bind by pdo
			':name' => $this->name,
			':email' => $this->email,
			':password' => $this->password,
			':id' => $this->id
			];	
		
		try {
			// use static method run() from class DB
	    	if ($stmt = DB::Run($query, $param)) { // we dont use fetch() or fetchAll() here
												   // because no data will be return when we
				                                   // perform update operation
	    		return true;
	    	};
		} catch (PDOException $e) {
			return $e->getMessage();
		}
	}

	public function delete()
	{
		$query = "DELETE FROM $this->table WHERE id=:id";
		$param = [':id' => $this->id]; // the parameter that will be bind by pdo

		try {
			// use static method run() from class DB
			if ($stmt = DB::Run($query, $param)) { // we dont use fetch() or fetchAll() here
												   // because no data will be return when we
				                                   // perform delete operation
				return true;
			}
		} catch (PDOException $e) {
			return $e->getMessage();
		}
	}

	public static function searchable($where_column, $data)
	{
		$query = "SELECT * FROM users WHERE `name` LIKE :where_param";
		echo $where_param = "%$data%";
		$param = [':where_param' => $where_param];

		try {
			// use static method run() from class DB
			if ($stmt = DB::Run($query, $param)) { 

				echo $stmt->queryString;

				// assign all of the data fetch from database to variable data
				$users=$stmt->fetchAll(PDO::FETCH_ASSOC); // need to add fetchAll for pdo 
														 // in order for pdo to retrieve the data from database

				if ($data == NULL) {
					$return = 'no data found';

					return $return;
				}

				// return the array of users filled with user array
				return $users;
			}
		} catch (PDOException $e) {
			return $e->getMessage();
		}
	}
}
              </code></pre>

              </div>
            </div><br>

          <div id="controller"><br>
            <h2 class="title is-2">Controller</h2>
            <hr>
            <p>Create a new Controller file called <i class="is-file">UserController.php</i> under Controller directory like so :</p>

            <p>
              Then create a controller class with 5 method, index(), add(), get(), update() and destroy()<br>
              We will add the logic inside the method later.
            </p>

            <p>First, require user model file that we will create after this in the top of controller's file</p>
            <pre><code class="language-php">require_once '../Model/User.php';</code></pre>
            <p>Next, Create a UserController class</p>

            <div class="box">
                <h4 id="const" class="title is-3">UserController.php</h4>
                <article class="message is-primary">
                  <span class="icon has-text-primary">
                  <i class="fab fa-php"></i>
                  </span>
                  <div class="message-body">
                    This is a controller file for User Model which will control/call the database operation from the model.
                  </div>
                </article>

            <pre><code class="language-php">
require_once '../Model/User.php';

/**
* 
*/
class UserController
{

	public function index($value='')
	{
		// assign the returned values(array of user object) to variable users
		$users = User::All(); // we use the static method All() that we
							  // created in user model to retrieve all 
							  // data for user
		return $users;
	}

	public function add($value='')
	{
		// create new user object
		$user = new User();

		// set the attributes of user object
		$user->name = $_POST['name'];
		$user->email = $_POST['email'];
		$user->password = $_POST['password'];

		// save new user into database
		$user->save();

		// set message
		Session::setFlash(['New record succesfully added'], 'success');
		return $this->redirect('index.php');
	}

	public function get($id)
	{
		// get user object associate with $id
		$user = User::getById($id);

		// return user object with the user details
		return $user;
	}

	public function update($id)
	{
		// get user data associate with $id
		$findUser = User::getById($id);

		// update/set the attributes of the user
		$user = new User();
		$user->id = $findUser['id'];
		$user->name = $_POST['name'];
		$user->email = $_POST['email'];
		$user->password = $_POST['password'];

		// update the user data in database
		$user->update();

		// set message
		Session::setFlash(['The record has been updated'], 'success');

		// redirect the page
		return $this->redirect('index.php');
	}

	public function destroy($id)
	{
		// get user data associate with $id
		$findUser = User::getById($id);

		// update/set the attributes of the user
		$user = new User();
		$user->id = $findUser['id'];
		// delete the user
		$user->delete();

		// set message
		Session::setFlash(['The record has been successfully deleted'], 'success');

		// redirect the page
		return $this->redirect('index.php');
	}

	public function search($value='')
	{
		
		$users = User::Searchable('name', $_GET['q']);

		return $users;
	}

	public function redirect($url) {
        header('Location: '.$url);
        exit();
    }
}
              </code></pre>

              </div>
          </div>
      </div>
    </div>
  </div>
</div>
</section>
<footer class="footer">
<section class="section">
  <div class="container">
    <div class="columns is-multiline">
      <div class="column is-one-third">
        <article class="notification media has-background-white">
          <figure class="media-left">
            <span class="icon">
              <i class="has-text-warning fas fa-columns fa-lg"></i>
            </span>
          </figure>
          <div class="media-content">
            <div class="content">
              <h1 class="title is-size-4">Columns</h1>
              <p class="is-size-5 subtitle">
                The power of <strong>Flexbox</strong> in a simple interface
              </p>
            </div>
          </div>
        </article>
      </div>
      <div class="column is-one-third">
        <article class="notification has-background-white media">
          <figure class="media-left">
            <span class="icon has-text-info">
              <i class="fab fa-lg fa-wpforms"></i>
            </span>
          </figure>
          <div class="media-content">
            <div class="content">
              <h1 class="title is-size-4">Form</h1>
              <p class="is-size-5 subtitle">
                The indispensable <strong>form controls</strong>, designed for maximum clarity
              </p>
            </div>
          </div>
        </article>
      </div>
      <div class="column is-one-third">
        <article class="notification has-background-white media">
          <figure class="media-left">
            <span class="icon has-text-danger">
              <i class="fas fa-lg fa-cubes"></i>
            </span>
          </figure>
          <div class="media-content">
            <div class="content">
              <h1 class="title is-size-4">Components</h1>
              <p class="is-size-5 subtitle">
                Advanced multi-part components with lots of possibilities
              </p>
            </div>
          </div>
        </article>
      </div>
      <div class="column is-one-third">
        <article class="notification has-background-white media">
          <figure class="media-left">
            <span class="icon has-text-grey">
              <i class="fas fa-lg fa-cogs"></i>
            </span>
          </figure>
          <div class="media-content">
            <div class="content">
              <h1 class="title is-size-4">Modifiers</h1>
              <p class="is-size-5 subtitle">
                An <strong>easy-to-read</strong> naming system designed for humans
              </p>
            </div>
          </div>
        </article>
      </div>
      <div class="column is-one-third">
        <article class="notification has-background-white media">
          <figure class="media-left">
            <span class="icon has-text-primary">
              <i class="fas fa-lg fa-warehouse"></i>
            </span>
          </figure>
          <div class="media-content">
            <div class="content">
              <h1 class="title is-size-4">Layout</h1>
              <p class="is-size-5 subtitle">
                Design the <strong>structure</strong> of your webpage with these CSS classes
              </p>
            </div>
          </div>
        </article>
      </div>
      <div class="column is-one-third">
        <article class="notification has-background-white media">
          <figure class="media-left">
            <span class="icon has-text-danger">
              <i class="fas fa-lg fa-cube"></i>
            </span>
          </figure>
          <div class="media-content">
            <div class="content">
              <h1 class="title is-size-4">Elements</h1>
              <p class="is-size-5 subtitle">
                Essential interface elements that only require a <strong>single CSS class</strong>
              </p>
            </div>
          </div>
        </article>
      </div>
    </div>
  </div>
</section>
<hr>
<div class="columns is-mobile is-centered">
  <div class="field is-grouped is-grouped-multiline">
    <div class="control">
      <div class="tags has-addons"><a class="tag is-link" href="https://github.com/dansup/bulma-templates">Bulma Templates</a>
      <span class="tag is-info">MIT license</span>
    </div>
  </div>
  <div class="control">
    <div class="tags has-addons">
      <span class="tag is-dark">based on a pen</span>
      <span class="tag has-addons is-warning"><a href="https://codepen.io/melanieseltzer/pen/odOXWM"><i class="fab fa-lg fa-codepen"></i></a></span>
    </div>
  </div>
</div>
</div>

</footer>
<script src='https://cdnjs.cloudflare.com/ajax/libs/prism/9000.0.1/prism.js'></script>
</body>
</html>

<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>

<script type="text/javascript">
  const app = new Vue ({
    el: '#root',
    data: {
      message: 'hello',
      params : '',
    },
    mounted() {
      this.params = location.hash;
    }
  })
</script>
